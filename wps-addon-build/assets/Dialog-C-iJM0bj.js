import{U as c,_ as u,c as k,a as e,d as a,t as p,e as m,o as b}from"./index-CHAXsPHL.js";import{a as w}from"./index-NIGUFBhG.js";function g(n,t){switch(n){case"getDocName":{let o=window.Application.ActiveWorkbook;return o?o.Name:"当前没有打开任何文档"}case"createTaskPane":{let o=window.Application.PluginStorage.getItem("taskpane_id");if(o){let l=window.Application.GetTaskPane(o);l.Visible=!0}else{let l=window.Application.CreateTaskPane(c.GetUrlPath()+"/taskpane"),r=l.ID;window.Application.PluginStorage.setItem("taskpane_id",r),l.Visible=!0}break}case"newDoc":{window.Application.Workbooks.Add();break}case"addString":{let o=window.Application.ActiveSheet;o&&(o.Cells.Item(1,1).Formula="Hello, wps加载项!"+o.Cells.Item(1,1).Formula);break}case"closeDoc":{if(window.Application.Workbooks.Count<2){alert("当前只有一个文档，别关了。");break}let o=window.Application.ActiveWorkbook;o&&o.Close();break}}}const d={onbuttonclick:g},v={name:"Dialog",data(){return{DemoSpan:"",docName:""}},methods:{onbuttonclick(n){return d.onbuttonclick(n)},onDocNameClick(){this.docName=d.onbuttonclick("getDocName")},onOpenWeb(){d.onbuttonclick("openWeb",this.DemoSpan)}}};m(()=>{w.get("/.debugTemp/NotifyDemoUrl").then(n=>{(void 0).DemoSpan=n.data})});const f={class:"hello"},D={class:"global"},A={class:"divItem"},C={class:"divItem"},I={class:"divItem"};function S(n,t,o,l,r,i){return b(),k("div",f,[e("div",D,[t[8]||(t[8]=e("div",{class:"divItem"},[a(" 这是一个网页，按"),e("span",{style:{"font-weight":"bolder"}},'"F12"'),a("可以打开调试器。 ")],-1)),e("div",A,[t[6]||(t[6]=a(" 这个示例展示了wps加载项的相关基础能力，与B/S业务系统的交互，请用浏览器打开： ",-1)),e("span",{style:{"font-weight":"bolder",color:"slateblue",cursor:"pointer"},onClick:t[0]||(t[0]=s=>i.onOpenWeb())},p(r.DemoSpan),1)]),t[9]||(t[9]=e("div",{class:"divItem"},[a(" 开发文档: "),e("span",{style:{"font-weight":"bolder",color:"slateblue"}},"https://open.wps.cn/docs/office")],-1)),t[10]||(t[10]=e("hr",null,null,-1)),e("div",C,[e("button",{style:{margin:"3px"},onClick:t[1]||(t[1]=s=>i.onDocNameClick())},"取文件名"),e("button",{style:{margin:"3px"},onClick:t[2]||(t[2]=s=>i.onbuttonclick("createTaskPane"))},"创建任务窗格"),e("button",{style:{margin:"3px"},onClick:t[3]||(t[3]=s=>i.onbuttonclick("newDoc"))},"新建文件"),e("button",{style:{margin:"3px"},onClick:t[4]||(t[4]=s=>i.onbuttonclick("addString"))},"文档开头添加字符串"),e("button",{style:{margin:"3px"},onClick:t[5]||(t[5]=s=>i.onbuttonclick("closeDoc"))},"关闭文件")]),t[11]||(t[11]=e("hr",null,null,-1)),e("div",I,[t[7]||(t[7]=a(" 文档文件名为：",-1)),e("span",null,p(r.docName),1)])])])}const y=u(v,[["render",S],["__scopeId","data-v-21e8e50e"]]);export{y as default};
